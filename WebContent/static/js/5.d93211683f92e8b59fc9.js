webpackJsonp([5],{LObY:function(e,t){},NSok:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});s("yFfA");var a={created:function(){this.checkLogin()},watch:{$route:"checkLogin"},data:function(){return{userModel:{},saleUrl:"/dachuang/releaseSale",saleModle:{name:"",price:"",sort:"",tel:"",qq:"",place:"",description:"",userID:"",img:""},showMsgModel:{name:!1,price:!1,tel:!1,qq:!1,place:!1,description:!1},success:{name:!1,price:!1,tel:!1,qq:!1,place:!1,description:!1},imgData:["","","",""],dataUrl:"",currentImg:0,loginUrl:"/dachuang/isStatus"}},methods:{checkLogin:function(){this.$http.get(this.loginUrl).then(function(e){0==e.body.code&&(console.log("用户未登录"),localStorage.user="",this.$router.push("/login"))},function(e){console.log(e),this.$router.push("/login")})},checkForm:function(e){for(var t in console.log(this.success),e)if(!0===e.hasOwnProperty(t)&&!e[t])return!1;return this.dataUrl?(this.dataUrl=this.delDataUrlHead(this.dataUrl),this.saleModle.img=this.dataUrl,this.saleModle.sort=this.$refs.select.selectedIndex+1,!0):(alert("请至少上传一张图片作为封面"),!1)},submmitForm:function(){console.log(this.saleModle),this.checkForm(this.success)&&this.$http.post(this.saleUrl,this.saleModle,{emulateJSON:!0}).then(function(e){console.log(e.body)})},checkEmpty:function(e,t){e?(this.showMsgModel[t]=!1,this.success[t]=!0):(this.showMsgModel[t]=!0,this.success[t]=!1)},checkNumber:function(e,t){/^[0-9]*$/.test(e)?(this.showMsgModel[t]=!1,this.success[t]=!0):(this.showMsgModel[t]=!0,this.success[t]=!1)},checkName:function(){this.saleModle.name.length<5?(this.showMsgModel.name=!0,this.success.name=!1):(this.showMsgModel.name=!1,this.success.name=!0)},onFileChange:function(e){var t=e.target.files||e.dataTransfer.files;if(console.log(t),t.length&&!(this.currentImg>=4)){var s=Math.floor(t[0].size/1024/1024);if(console.log(s),s>10)return!1;this.createImage(t[0])}},createImage:function(e){new Image;var t=new FileReader,s=this;t.onloadend=function(){s.dataUrl=this.result;var e=s.currentImg;s.imgData[e]=this.result,s.currentImg++},t.readAsDataURL(e)},delDataUrlHead:function(e){var t=e.indexOf(",")+1;return e.substring(t)}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"releaseSale"},[s("div",{staticClass:"head"}),e._v(" "),s("form",{staticClass:"saleForm"},[s("div",{class:{warnActive:e.showMsgModel.name}},[s("label",[e._v("标题*")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.saleModle.name,expression:"saleModle.name"}],attrs:{type:"text"},domProps:{value:e.saleModle.name},on:{blur:e.checkName,input:[function(t){t.target.composing||e.$set(e.saleModle,"name",t.target.value)},e.checkName]}}),e._v(" "),e.showMsgModel.name?s("span",[e._v("标题不能少于5个字符")]):e._e()]),e._v(" "),s("div",{class:{warnActive:e.showMsgModel.price}},[s("label",[e._v("价格*")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.saleModle.price,expression:"saleModle.price"}],attrs:{type:"text"},domProps:{value:e.saleModle.price},on:{blur:function(t){e.checkNumber(e.saleModle.price,"price")},input:function(t){t.target.composing||e.$set(e.saleModle,"price",t.target.value)}}}),e._v(" "),e.showMsgModel.price?s("span",[e._v("价格必须为整数")]):e._e()]),e._v(" "),s("div",[s("label",[e._v("分类")]),e._v(" "),s("select",{ref:"select"},[s("option",[e._v("代步工具")]),e._v(" "),s("option",[e._v("手机")]),e._v(" "),s("option",[e._v("电脑")]),e._v(" "),s("option",[e._v("数码")]),e._v(" "),s("option",[e._v("电器")]),e._v(" "),s("option",[e._v("书籍")]),e._v(" "),s("option",[e._v("衣物")]),e._v(" "),s("option",[e._v("体育健身")]),e._v(" "),s("option",[e._v("乐器")]),e._v(" "),s("option",[e._v("其他")])])]),e._v(" "),s("div",{class:{warnActive:e.showMsgModel.place}},[s("label",[e._v("交易地点")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.saleModle.place,expression:"saleModle.place"}],attrs:{type:"text"},domProps:{value:e.saleModle.place},on:{blur:function(t){e.checkEmpty(e.saleModle.place,"place")},input:function(t){t.target.composing||e.$set(e.saleModle,"place",t.target.value)}}}),e._v(" "),e.showMsgModel.place?s("span",[e._v("请填写交易地点")]):e._e()]),e._v(" "),s("div",{class:{warnActive:e.showMsgModel.tel}},[s("label",[e._v("手机")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.saleModle.tel,expression:"saleModle.tel"}],attrs:{type:"text"},domProps:{value:e.saleModle.tel},on:{blur:function(t){e.checkNumber(e.saleModle.tel,"tel")},input:function(t){t.target.composing||e.$set(e.saleModle,"tel",t.target.value)}}}),e._v(" "),e.showMsgModel.tel?s("span",[e._v("手机必须为数字")]):e._e()]),e._v(" "),s("div",{class:{warnActive:e.showMsgModel.qq}},[s("label",[e._v("QQ")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.saleModle.qq,expression:"saleModle.qq"}],attrs:{type:"text"},domProps:{value:e.saleModle.qq},on:{blur:function(t){e.checkNumber(e.saleModle.qq,"qq")},input:function(t){t.target.composing||e.$set(e.saleModle,"qq",t.target.value)}}}),e._v(" "),e.showMsgModel.qq?s("span",[e._v("QQ必须为数字")]):e._e()]),e._v(" "),s("div",{class:{warnActive:e.showMsgModel.description}},[s("label",[e._v("详情介绍")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.saleModle.description,expression:"saleModle.description"}],domProps:{value:e.saleModle.description},on:{blur:function(t){e.checkEmpty(e.saleModle.description,"description")},input:function(t){t.target.composing||e.$set(e.saleModle,"description",t.target.value)}}}),e._v(" "),e.showMsgModel.descrition?s("span",[e._v("请填写详细介绍")]):e._e()]),e._v(" "),s("div",[s("label",[e._v("上传图片")]),e._v(" "),s("input",{attrs:{value:"上传",type:"file"},on:{change:e.onFileChange}})]),e._v(" "),s("div",{staticClass:"imgWrapper"},[s("img",{staticClass:"preImg",attrs:{src:e.dataUrl,id:"firstImg"}}),e._v(" "),s("img",{staticClass:"preImg",attrs:{src:e.imgData[0]}}),e._v(" "),s("img",{staticClass:"preImg",attrs:{src:e.imgData[1]}}),e._v(" "),s("img",{staticClass:"preImg",attrs:{src:e.imgData[2]}}),e._v(" "),s("img",{staticClass:"preImg",attrs:{src:e.imgData[3]}})]),e._v(" "),s("div",[s("input",{staticClass:"subButton",attrs:{type:"button",value:"提交"},on:{click:e.submmitForm}})])])])},staticRenderFns:[]};var o=s("VU/8")(a,l,!1,function(e){s("LObY")},"data-v-d8031c06",null);t.default=o.exports}});
//# sourceMappingURL=5.d93211683f92e8b59fc9.js.map